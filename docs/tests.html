
<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta content="text/javascript" http-equiv="content-script-type">
<title>dstats.tests</title>
<link rel="stylesheet" type="text/css" href="candydoc/style.css">
<!--[if lt IE 7]><link rel="stylesheet" type="text/css" href="candydoc/ie56hack.css"><![endif]-->
<script language="JavaScript" src="candydoc/util.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/tree.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/explorer.js" type="text/javascript"></script>
</head><body>
<div id="tabarea"></div><div id="explorerclient"></div>
<div id="content"><script>explorer.initialize("dstats.tests");</script>
	<table class="content">
		<tr><td id="docbody"><h1>dstats.tests</h1><!-- Generated by Ddoc from dstats\tests.d -->
Hypothesis testing beyond simple CDFs.  All functions work with input
 ranges with elements implicitly convertible to double unless otherwise noted.
<br><br>
<b>Author:</b><br>
David Simcha<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">enum 
<span class="currsymbol">Alt</span>
<script>explorer.outline.addDecl('Alt');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Alternative hypotheses.  Exact meaning varies with test used.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">twoSided</span>
<script>explorer.outline.addDecl('twoSided');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>f(input1) != X<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">less</span>
<script>explorer.outline.addDecl('less');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>f(input1) &lt; X<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">greater</span>
<script>explorer.outline.addDecl('greater');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>f(input1) &gt; X<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">none</span>
<script>explorer.outline.addDecl('none');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Skip P-value computation (and confidence intervals if applicable)
    and just return the test statistic.<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">TestRes</span>
<script>explorer.outline.addDecl('TestRes');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A plain old data struct for returning the results of hypothesis tests.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">testStat</span>
<script>explorer.outline.addDecl('testStat');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The test statistic.  What exactly this is is specific to the test.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">p</span>
<script>explorer.outline.addDecl('p');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The P-value against the provided alternative.  This struct can
 be implicitly converted to just the P-value via alias this.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">string 
<span class="currsymbol">toString</span>
<script>explorer.outline.addDecl('toString');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">ConfInt</span>
<script>explorer.outline.addDecl('ConfInt');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A plain old data struct for returning the results of hypothesis tests
that also produce confidence intervals.  Contains, can implicitly convert
to, a TestRes.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">testRes</span>
<script>explorer.outline.addDecl('testRes');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>This is alias this'd.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">lowerBound</span>
<script>explorer.outline.addDecl('lowerBound');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Lower bound of the confidence interval at the level specified.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">upperBound</span>
<script>explorer.outline.addDecl('upperBound');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Upper bound of the confidence interval at the level specified.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">string 
<span class="currsymbol">toString</span>
<script>explorer.outline.addDecl('toString');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">template 
<span class="currsymbol">isSummary</span>
<script>explorer.outline.addDecl('isSummary');</script>

(T)</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Tests whether a struct/class has the necessary information for calculating
a T-test.  It must have a property .mean (mean), .stdev (stdandard deviation),
.var (variance), and .N (sample size).<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">studentsTTest</span>
<script>explorer.outline.addDecl('studentsTTest');</script>

(T)(T <span class="funcparam">data</span>, double <span class="funcparam">testMean</span> = 0, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>One-sample Student's T-test for difference between mean of data and
 a fixed value.  Alternatives are Alt.less, meaning mean(data) &lt; testMean,
 Alt.greater, meaning mean(data) &gt; testMean, and Alt.twoSided, meaning
 mean(data)!= testMean.
<br><br>
data may be either an iterable with elements implicitly convertible to
 double or a summary struct (see isSummary).

<br><br>
<b>Examples:</b><br>
<pre class="d_code"> <font color=blue>uint</font>[] data = [1,2,3,4,5];

 <font color=green>// Test the null hypothesis that the mean of data is &gt;= 1 against the
</font> <font color=green>// alternative that the mean of data is &lt; 1.  Calculate confidence
</font> <font color=green>// intervals at 90%.
</font> <font color=blue>auto</font> result1 = <u>studentsTTest</u>(data, 1, Alt.less, 0.9);

 <font color=green>// Do the same thing, only this time we've already calculated the summary
</font> <font color=green>// statistics explicitly before passing them to studensTTest.
</font> <font color=blue>auto</font> summary = meanStdev(data);
 writeln(summary.stdev);
 result2 = <u>studentsTTest</u>(summary, 1, Alt.less, 0.9);  <font color=green>// Same as result1.
</font> <font color=blue>assert</font>(result1 == result2);
</pre>

<br><br>
<b>Returns:</b><br>
A ConfInt containing T, the P-value and the boundaries of
 the confidence interval for mean(data) at the level specified.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Student%27s_t-test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">studentsTTest</span>
<script>explorer.outline.addDecl('studentsTTest');</script>

(T, U)(T <span class="funcparam">sample1</span>, U <span class="funcparam">sample2</span>, double <span class="funcparam">testMean</span> = 0, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Two-sample T test for a difference in means,
assumes variances of samples are equal.  Alteratives are Alt.less, meaning
mean(sample1) - mean(sample2) &lt; testMean, Alt.greater, meaning
mean(sample1) - mean(sample2) &gt; testMean, and Alt.twoSided, meaning
mean(sample1) - mean(sample2) != testMean.
<br><br>
sample1 and sample2 may be either iterables with elements implicitly
convertible to double or summary structs (see isSummary).

<br><br>
<b>Returns:</b><br>
A ConfInt containing the T statistic, the P-value, and the
boundaries of the confidence interval for the difference between means
of sample1 and sample2 at the specified level.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Student%27s_t-test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">welchTTest</span>
<script>explorer.outline.addDecl('welchTTest');</script>

(T, U)(T <span class="funcparam">sample1</span>, U <span class="funcparam">sample2</span>, double <span class="funcparam">testMean</span> = 0, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Two-sample T-test for difference in means.  Does not assume variances are equal.
Alteratives are Alt.less, meaning mean(sample1) - mean(sample2) &lt; testMean,
Alt.greater, meaning mean(sample1) - mean(sample2) &gt; testMean, and
Alt.twoSided, meaning mean(sample1) - mean(sample2) != testMean.
<br><br>
sample1 and sample2 may be either iterables with elements implicitly
convertible to double or summary structs (see isSummary).

<br><br>
<b>Returns:</b><br>
A ConfInt containing the T statistic, the P-value, and the
boundaries of the confidence interval for the difference between means
of sample1 and sample2 at the specified level.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Student%27s_t-test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">pairedTTest</span>
<script>explorer.outline.addDecl('pairedTTest');</script>

(T, U)(T <span class="funcparam">before</span>, U <span class="funcparam">after</span>, double <span class="funcparam">testMean</span> = 0, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Paired T test.  Tests the hypothesis that the mean difference between
corresponding elements of before and after is testMean.  Alternatives are
Alt.less, meaning the that the <b>true</b> mean difference (before[i] - after[i])
is less than testMean, Alt.greater, meaning the <b>true</b> mean difference is
greater than testMean, and Alt.twoSided, meaning the <b>true</b> mean difference is not
equal to testMean.
<br><br>
before and after must be input ranges with elements implicitly convertible
to double and must have the same length.

<br><br>
<b>Returns:</b><br>
A ConfInt containing the T statistic, the P-value, and the
boundaries of the confidence interval for the mean difference between
corresponding elements of sample1 and sample2 at the specified level.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Student%27s_t-test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">pairedTTest</span>
<script>explorer.outline.addDecl('pairedTTest');</script>

(T)(T <span class="funcparam">diffSummary</span>, double <span class="funcparam">testMean</span> = 0, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Compute a paired T test directly from summary statistics of the differences
between corresponding samples.
<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=blue>float</font>[] data1 = [8, 6, 7, 5, 3, 0, 9];
<font color=blue>float</font>[] data2 = [3, 6, 2, 4, 3, 6, 8];

<font color=green>// Calculate summary statistics on difference explicitly.
</font>MeanSD summary;
<font color=blue>foreach</font>(i; 0..data1.length) {
    summary.put(data1[i] - data2[i]);
}

<font color=green>// Test the null hypothesis that the mean difference between corresponding
</font><font color=green>// elements (data1[i] - data2[i]) is greater than 5 against the null that it
</font><font color=green>// is &lt;= 5.  Calculate confidence intervals at 99%.
</font><font color=blue>auto</font> result = <u>pairedTTest</u>(summary, 5, Alt.twoSided, 0.99);

<font color=green>// This is equivalent to:
</font><font color=blue>auto</font> result2 = <u>pairedTTest</u>(data1, data2, 5, Alt.twoSided, 0.99);
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Student%27s_t-test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">levenesTest</span>
<script>explorer.outline.addDecl('levenesTest');</script>

(alias central = median, T...)(T <span class="funcparam">data</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Tests the <b>null</b> hypothesis that the variances of all groups are equal against
the alternative that heteroscedasticity exists.  data must be either a
tuple of ranges or a range of ranges.  central is an alias for the measure
of central tendency to be used.  This can be any function that maps a
forward range of numeric types to a numeric type.  The commonly used ones
are median (default) and mean (less robust).  Trimmed mean is sometimes
useful, but is currently not implemented in dstats.summary.
<br><br>
<b>References:</b><br>
Levene, Howard (1960). "Robust tests for equality of variances". in Ingram
Olkin, Harold Hotelling et al. Contributions to Probability and Statistics:
Essays in Honor of Harold Hotelling. Stanford University Press. pp. 278-292.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=blue>int</font>[] sample1 = [1,2,3,4,5];
<font color=blue>int</font>[] sample2 = [100,200,300,400,500];
<font color=blue>auto</font> result = <u>levenesTest</u>(sample1, sample2);

<font color=green>// Clearly the variances are different between these two samples.
</font><font color=blue>assert</font>( approxEqual(result.testStat, 10.08));
<font color=blue>assert</font>( approxEqual(result.p, 0.01310));
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">fTest</span>
<script>explorer.outline.addDecl('fTest');</script>

(T...)(T <span class="funcparam">data</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The F-test is a one-way ANOVA extension of the T-test to &gt;2 groups.
It's useful when you have 3 or more groups with equal variance and want
to test whether their means are equal.  Data can be input as either a
tuple or a range.  This may contain any combination of ranges of numeric
types, MeanSD structs and Summary structs.
<br><br>
<b>Note:</b><br>
This test makes the assumption that all groups have equal variances,
also known as homoskedasticity.  For a similar test that does not make these
assumptions, see welchAnova.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=blue>uint</font>[] thing1 = [3,1,4,1],
       thing2 = [5,9,2,6,5,3],
       thing3 = [5,8,9,7,9,3];
<font color=blue>auto</font> result = <u>fTest</u>(thing1, meanStdev(thing2), summary(thing3));
<font color=blue>assert</font>(approxEqual(result.testStat, 4.9968));
<font color=blue>assert</font>(approxEqual(result.p, 0.02456));
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/F-test

<br><br>
<b>Returns:</b><br>
A TestRes containing the F statistic and the P-value for the alternative
that the means of the groups are different against the <b>null</b> that they
are identical.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">welchAnova</span>
<script>explorer.outline.addDecl('welchAnova');</script>

(T...)(T <span class="funcparam">data</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Same as fTest, except that this test does not require the assumption of
equal variances.  In exchange it's slightly less powerful.
<br><br>
<b>References:</b><br>
B.L. Welch. On the Comparison of Several Mean Values: An Alternative Approach
Biometrika, Vol. 38, No. 3/4 (Dec., 1951), pp. 330-336.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">correlatedAnova</span>
<script>explorer.outline.addDecl('correlatedAnova');</script>

(T...)(T <span class="funcparam">dataIn</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Performs a correlated sample (within-subjects) ANOVA.  This is a
 generalization of the paired T-test to 3 or more treatments.  This
 function accepts data as either a tuple of ranges (1 for each treatment,
 such that a given index represents the same subject in each range) or
 similarly as a range of ranges.
<br><br>
<b>Returns:</b><br>
A TestRes with the F-statistic and P-value for the <b>null</b> that
 the the variable being measured did not vary across treatments against the
 alternative that it did.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"> <font color=green>// Test the hypothesis that alcohol, loud music, caffeine and sleep
</font> <font color=green>// deprivation all have equivalent effects on programming ability.
</font>
 <font color=blue>uint</font>[] alcohol = [8,6,7,5,3,0,9];
 <font color=blue>uint</font>[] caffeine = [3,6,2,4,3,6,8];
 <font color=blue>uint</font>[] noSleep = [3,1,4,1,5,9,2];
 <font color=blue>uint</font>[] loudMusic = [2,7,1,8,2,8,1];
 <font color=green>// Subject 0 had ability of 8 under alcohol, 3 under caffeine, 3 under
</font> <font color=green>// no sleep, 2 under loud music.  Subject 1 had ability of 6 under alcohol,
</font> <font color=green>// 6 under caffeine, 1 under no sleep, and 7 under loud music, etc.
</font> <font color=blue>auto</font> result = <u>correlatedAnova</u>(alcohol, caffeine, noSleep, loudMusic);
</pre>

<br><br>
<b>References:</b><br>
"Concepts and Applications of Inferrential Statistics".
              Richard Lowry.  Vassar College.   version.
<br><br>
<b>http:</b><br>
//faculty.vassar.edu/lowry/webtext.html<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">kruskalWallis</span>
<script>explorer.outline.addDecl('kruskalWallis');</script>

(T...)(T <span class="funcparam">dataIn</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The Kruskal-Wallis rank sum test.  Tests the <b>null</b> hypothesis that data in
 each group is not stochastically ordered with respect to data in each other
 groups.  This is a one-way non-parametric ANOVA and can be thought of
 as either a generalization of the Wilcoxon rank sum test to &gt;2 groups or
 a non-parametric equivalent to the F-test.  Data can be input as either a
 tuple of ranges (one range for each group) or a range of ranges
 (one element for each group).
<br><br>
<font color=red>BUGS:</font><br>
Asymptotic approximation of P-value only, not exact.  In this case,
 I'm not sure a practical way to compute the exact P-value even exists.

<br><br>
<b>Returns:</b><br>
A TestRes with the K statistic and the P-value for the <b>null</b> that
 no group is stochastically larger than any other against the alternative that
 groups are stochastically ordered.

<br><br>
<b>References:</b><br>
"Concepts and Applications of Inferrential Statistics".
              Richard Lowry.  Vassar College.   version.
<br><br>
<b>http:</b><br>
//faculty.vassar.edu/lowry/webtext.html<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">friedmanTest</span>
<script>explorer.outline.addDecl('friedmanTest');</script>

(T...)(T <span class="funcparam">dataIn</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The Friedman test is a non-parametric within-subject ANOVA.  It's useful
 when parametric assumptions cannot be made.  Usage is identical to
 correlatedAnova().
<br><br>
<b>References:</b><br>
"Concepts and Applications of Inferrential Statistics".
              Richard Lowry.  Vassar College.   version.
<br><br>
<b>http:</b><br>
//faculty.vassar.edu/lowry/webtext.html

<br><br>
<font color=red>BUGS:</font><br>
No exact P-value calculation.  Asymptotic approx. only.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">wilcoxonRankSum</span>
<script>explorer.outline.addDecl('wilcoxonRankSum');</script>

(T, U)(T <span class="funcparam">sample1</span>, U <span class="funcparam">sample2</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, uint <span class="funcparam">exactThresh</span> = 50);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Computes Wilcoxon rank sum test statistic and P-value for
 a set of observations against another set, using the given alternative.
 Alt.less means that sample1 is stochastically less than sample2.
 Alt.greater means sample1 is stochastically greater than sample2.
 Alt.twoSided means sample1 is stochastically less than or greater than
 sample2.
<br><br>
exactThresh is the threshold value of (n1 + n2) at which this function
 switches from exact to approximate computation of the p-value.  Do not set
 exactThresh to more than 200, as the exact
 calculation is both very slow and not numerically stable past this point,
 and the asymptotic calculation is very good for N this large.  To disable
 exact calculation entirely, set exactThresh to 0.

<br><br>
<b>Notes:</b><br>
Exact p-value computation is never used when ties are present in the
 data, because it is not computationally feasible.
<br><br>

 Input ranges for this function must define a length.
<br><br>

 This test is also known as the Mann-Whitney U test.

<br><br>
<b>Returns:</b><br>
A TestRes containing the W test statistic and the P-value against
 the given alternative.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Mann%E2%80%93Whitney_U
<br><br>

 StackOverflow Question 376003  http://stackoverflow.com/questions/376003
<br><br>

 Loughborough University MLSC Statistics 2.3 The Mann-Whitney U Test
<br><br>
<b>http:</b><br>
//mlsc.lboro.ac.uk/resources/statistics/Mannwhitney.pdf<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">wilcoxonSignedRank</span>
<script>explorer.outline.addDecl('wilcoxonSignedRank');</script>

(T, U)(T <span class="funcparam">before</span>, U <span class="funcparam">after</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, uint <span class="funcparam">exactThresh</span> = 50);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Computes a test statistic and P-value for a Wilcoxon signed rank test against
 the given alternative. Alt.less means that elements of before are stochastically
 less than corresponding elements of after.  Alt.greater means elements of
 before are stochastically greater than corresponding elements of after.
 Alt.twoSided means there is a significant difference in either direction.
<br><br>
exactThresh is the threshold value of before.length at which this function
 switches from exact to approximate computation of the p-value.   Do not set
 exactThresh to more than 200, as the exact calculation is both very slow and
 not numerically stable past this point, and the asymptotic calculation is
 very good for N this large.  To disable exact calculation entirely, set
 exactThresh to 0.

<br><br>
<b>Notes:</b><br>
Exact p-value computation is never used when ties are present,
 because it is not computationally feasible.
<br><br>

 The input ranges for this function must define a length and must be
 forward ranges.

<br><br>
<b>Returns:</b><br>
A TestRes of the W statistic and the p-value against the given
 alternative.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Wilcoxon_signed-rank_test
<br><br>

 StackOverflow Question 376003  http://stackoverflow.com/questions/376003
<br><br>

 Handbook of Parametric and nonparametric statistical procedures. David Sheskin.
 Third Edition. (2004)  CRC Press. Pg. 616.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">wilcoxonSignedRank</span>
<script>explorer.outline.addDecl('wilcoxonSignedRank');</script>

(T)(T <span class="funcparam">data</span>, double <span class="funcparam">mu</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, uint <span class="funcparam">exactThresh</span> = 50);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Same as the overload, but allows testing whether a range is stochastically
 less than or greater than a fixed value mu rather than paired elements of
 a second range.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">signTest</span>
<script>explorer.outline.addDecl('signTest');</script>

(T, U)(T <span class="funcparam">before</span>, U <span class="funcparam">after</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Sign test for differences between paired values.  This is a very robust
 but very low power test.  Alternatives are Alt.less, meaning elements
 of before are typically less than corresponding elements of after,
 Alt.greater, meaning elements of before are typically greater than
 elements of after, and Alt.twoSided, meaning that there is a significant
 difference in either direction.
<br><br>
<b>Returns:</b><br>
A TestRes with the proportion of elements of before that were
 greater than the corresponding element of after, and the P-value against
 the given alternative.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">signTest</span>
<script>explorer.outline.addDecl('signTest');</script>

(T)(T <span class="funcparam">data</span>, double <span class="funcparam">mu</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Similar to the overload, but allows testing for a difference between a
 range and a fixed value mu.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">binomialTest</span>
<script>explorer.outline.addDecl('binomialTest');</script>

(ulong <span class="funcparam">k</span>, ulong <span class="funcparam">n</span>, double <span class="funcparam">p</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Two-sided binomial test for whether P(success) == <span class="funcparam">p</span>.  The one-sided
alternatives are covered by dstats.distrib.binomialCDF and binomialCDFR.
<span class="funcparam">k</span> is the number of successes observed, <span class="funcparam">n</span> is the number of trials, <span class="funcparam">p</span>
is the probability of success under the <b>null</b>.
<br><br>
<b>Returns:</b><br>
The P-value for the alternative that P(success) != <span class="funcparam">p</span> against
the <b>null</b> that P(success) == <span class="funcparam">p</span>.

<br><br>
<b>Notes:</b><br>
This test can also be performed using multinomialTest, but this
implementation is much faster and easier to use.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">enum 
<span class="currsymbol">Expected</span>
<script>explorer.outline.addDecl('Expected');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>For chiSquareFit and gTestFit, is expected value range counts or proportions?<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">count</span>
<script>explorer.outline.addDecl('count');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">proportion</span>
<script>explorer.outline.addDecl('proportion');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">chiSquareFit</span>
<script>explorer.outline.addDecl('chiSquareFit');</script>

(T, U)(T <span class="funcparam">observed</span>, U <span class="funcparam">expected</span>, Expected <span class="funcparam">countProp</span> = Expected.proportion);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Performs a one-way Pearson's chi-square goodness of fit test between a range
of observed and a range of expected values.  This is a useful statistical
test for testing whether a set of observations fits a discrete distribution.
<br><br>
<b>Returns:</b><br>
A TestRes of the chi-square statistic and the P-value for the
alternative hypothesis that observed is not a sample from expected against
the <b>null</b> that observed is a sample from expected.

<br><br>
<b>Notes:</b><br>
By default, expected is assumed to be a range of expected proportions.
These proportions are automatically normalized, and can sum to any number.
By passing Expected.count in as the last parameter, calculating expected
counts will be skipped, and expected will assume to already be properly
normalized.  This is slightly faster, but more importantly
allows input ranges to be used.
<br><br>

The chi-square test relies on asymptotic statistical properties
and is therefore not considered valid, as a rule of thumb,  when expected
counts are below 5.  However, this rule is likely to be unnecessarily
stringent in most cases.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=green>// Test to see whether a set of categorical observations differs
</font><font color=green>// statistically from a discrete uniform distribution.
</font>
<font color=blue>uint</font>[] observed = [980, 1028, 1001, 964, 1102];
<font color=blue>auto</font> expected = repeat(1.0);
<font color=blue>auto</font> res2 = <u>chiSquareFit</u>(observed, expected);
<font color=blue>assert</font>(approxEqual(res2, 0.0207));
<font color=blue>assert</font>(approxEqual(res2.testStat, 11.59));
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Pearson%27s_chi-square_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">gTestFit</span>
<script>explorer.outline.addDecl('gTestFit');</script>

(T, U)(T <span class="funcparam">observed</span>, U <span class="funcparam">expected</span>, Expected <span class="funcparam">countProp</span> = Expected.proportion);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The G or likelihood ratio chi-square test for goodness of fit.  Roughly
 the same as Pearson's chi-square test (chiSquareFit), but may be more
 accurate in certain situations and less accurate in others.  However, it is
 still based on asymptotic distributions, and is not exact. Usage is is
 identical to chiSquareFit.
<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/G_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">multinomialTest</span>
<script>explorer.outline.addDecl('multinomialTest');</script>

(U, F)(U <span class="funcparam">countsIn</span>, F <span class="funcparam">proportions</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The exact multinomial goodness of fit test for whether a set of counts
fits a hypothetical distribution.  counts is an input range of counts.
proportions is an input range of expected proportions.  These are normalized
automatically, so they can sum to any value.
<br><br>
<b>Returns:</b><br>
The P-value for the <b>null</b> that counts is a sample from proportions
against the alternative that it isn't.

<br><br>
<b>Notes:</b><br>
This test is EXTREMELY slow for anything but very small samples and
degrees of freedom.  The Pearson's chi-square (chiSquareFit()) or likelihood
ratio chi-square (gTestFit()) are good enough approximations unless sample
size is very small.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">chiSquareContingency</span>
<script>explorer.outline.addDecl('chiSquareContingency');</script>

(T...)(T <span class="funcparam">inputData</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Performs a Pearson's chi-square test on a contingency table of arbitrary
dimensions.  When the chi-square test is mentioned, this is usually the one
being referred to.  Takes a set of finite forward ranges, one for each column
in the contingency table.  These can be expressed either as a tuple of ranges
or a range of ranges.  Returns a P-value for the alternative hypothesis that
frequencies in each row of the contingency table depend on the column against
the <b>null</b> that they don't.
<br><br>
<b>Notes:</b><br>
The chi-square test relies on asymptotic statistical properties
and is therefore not exact.  The typical rule of thumb is that each cell
should have an expected value of at least 5.  However, this is likely to
be unnecessarily stringent.
<br><br>

Yates's continuity correction is never used in this implementation.  If
you want something that's guaranteed to be conservative, use fisherExact().
<br><br>

This is, for all practical purposes, an inherently non-directional test.
Therefore, the one-sided verses two-sided option is not provided.
<br><br>

For 2x2 contingency tables, fisherExact is a more conservative test, in that
the type I error rate is guaranteed to never be above the nominal P-value.
However, even for small sample sizes this test may produce results closer
to the <b>true</b> P-value, at the risk of possibly being non-conservative.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=green>// Test to see whether the relative frequency of outcome 0, 1, and 2
</font><font color=green>// depends on the treatment (drug1, drug2 or placebo) in some hypothetical
</font><font color=green>// experiment.  For example, 1500 people had outcome 2 if they were treated
</font><font color=green>// with drug1 and 1100 had outcome 1 if treated with placebo.
</font><font color=blue>uint</font>[] drug1 = [1000, 2000, 1500];
<font color=blue>uint</font>[] drug2 = [1500, 3000, 2300];
<font color=blue>uint</font>[] placebo = [500, 1100, 750];
<font color=blue>auto</font> result1 = <u>chiSquareContingency</u>(drug1, drug2, placebo);

<font color=green>// The following uses a range of ranges instead of an array of ranges,
</font><font color=green>// and will produce equivalent results.
</font><font color=blue>auto</font> rangeOfRanges = [drug1, drug2, placebo];
<font color=blue>auto</font> result2 = <u>chiSquareContingency</u>(rangeOfRanges);
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Pearson%27s_chi-square_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">GTestRes</span>
<script>explorer.outline.addDecl('GTestRes');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>This struct is a subtype of TestRes and is used to return the results of
gTestContingency and gTestObs.  Due to the information theoretic interpretation
of the G test, it contains an extra field to return the mutual information
in bits.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">testRes</span>
<script>explorer.outline.addDecl('testRes');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">mutualInfo</span>
<script>explorer.outline.addDecl('mutualInfo');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The mutual info of the two random variables in the joint distribution
    represented by the contingency table, in bits (base 2).<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">GTestRes 
<span class="currsymbol">gTestContingency</span>
<script>explorer.outline.addDecl('gTestContingency');</script>

(T...)(T <span class="funcparam">inputData</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>The G or likelihood ratio chi-square test for contingency tables.  Roughly
the same as Pearson's chi-square test (chiSquareContingency), but may be more
accurate in certain situations and less accurate in others.
<br><br>
Like Pearson's Chi-square, the G-test is based on asymptotic distributions,
and is not exact. Usage is is identical to chiSquareContingency.

<br><br>
<b>Note:</b><br>
This test can be thought of as a test for nonzero mutual information
between the random variables represented by the rows and the columns,
since the test statistic and P-value are strictly increasing
and strictly decreasing, respectively, in mutual information.  Therefore, this
function returns a GTestRes, which is a subtype of TestRes and also gives
the mutual information for use in information theoretic settings.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/G_test, last retrieved 1/22/2011<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">chiSquareObs</span>
<script>explorer.outline.addDecl('chiSquareObs');</script>

(T, U)(T <span class="funcparam">x</span>, U <span class="funcparam">y</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Given two vectors of observations of jointly distributed variables x, y, tests
the <b>null</b> hypothesis that values in x are independent of the corresponding
values in y.  This is done using Pearson's Chi-Square Test.  For a similar test
that assumes the data has already been tabulated into a contingency table, see
chiSquareContingency.
<br><br>
x and y must both be input ranges.  If they are not the same length, a
DstatsArgumentException is thrown.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=green>// Test whether the appearance of "foo" vs. "bar" is independent of the
</font><font color=green>// appearance of "baz" vs. "xxx".
</font><font color=blue>auto</font> x = [<font color=red>"foo"</font>, <font color=red>"bar"</font>, <font color=red>"bar"</font>, <font color=red>"foo"</font>, <font color=red>"foo"</font>];
<font color=blue>auto</font> y = [<font color=red>"xxx"</font>, <font color=red>"baz"</font>, <font color=red>"baz"</font>, <font color=red>"xxx"</font>, <font color=red>"baz"</font>];
<font color=blue>auto</font> result = <u>chiSquareObs</u>(x, y);

<font color=green>// This is equivalent to:
</font><font color=blue>auto</font> contingency = <font color=blue>new</font> <font color=blue>uint</font>[][](2, 2);
<font color=blue>foreach</font>(i; 0..x.length) {
    <font color=blue>immutable</font> index1 = (x[i] == <font color=red>"foo"</font>);
    <font color=blue>immutable</font> index2 = (y[i] == <font color=red>"xxx"</font>);
    contingency[index1][index2]++;
}

<font color=blue>auto</font> result2 = chiSquareContingency(contingency);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">GTestRes 
<span class="currsymbol">gTestObs</span>
<script>explorer.outline.addDecl('gTestObs');</script>

(T, U)(T <span class="funcparam">x</span>, U <span class="funcparam">y</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Given two ranges of observations of jointly distributed variables x, y, tests
the <b>null</b> hypothesis that values in x are independent of the corresponding
values in y.  This is done using the Likelihood Ratio G test.  Usage is similar
to chiSquareObs.  For an otherwise identical test that assumes the data has
already been tabulated into a contingency table, see gTestContingency.
<br><br>
<b>Note:</b><br>
This test can be thought of as a test for nonzero mutual information
between x and y, since the test statistic and P-value are strictly increasing
and strictly decreasing, respectively, in mutual information.  Therefore, this
function returns a GTestRes, which is a subtype of TestRes and also gives
the mutual information for use in information theoretic settings.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">fisherExact</span>
<script>explorer.outline.addDecl('fisherExact');</script>

(T)(const T[2][2] <span class="funcparam">contingencyTable</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Fisher's Exact test for difference in odds between rows/columns
in a 2x2 contingency table.  Specifically, this function tests the odds
ratio, which is defined, for a contingency table c, as (c[0][0] * c[1][1])
 / (c[1][0] * c[0][1]).  Alternatives are Alt.less, meaning <b>true</b> odds ratio
&lt; 1, Alt.greater, meaning <b>true</b> odds ratio &gt; 1, and Alt.twoSided, meaning
<b>true</b> odds ratio != 1.
<br><br>
Accepts a 2x2 contingency table as an array of arrays of uints.
For now, only does 2x2 contingency tables.

<br><br>
<b>Notes:</b><br>
Although this test is "exact" in that it does not rely on asymptotic
approximations, it is very statistically conservative when the marginals
are not truly fixed in the experimental design in question.  If a
closer but possibly non-conservative approximation of the <b>true</b> P-value is
desired, Pearson's chi-square test (chiSquareContingency) may perform better,
even for small samples.

<br><br>
<b>Returns:</b><br>
A TestRes of the odds ratio and the P-value against the given
alternative.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=blue>double</font> res = <u>fisherExact</u>([[2u, 7], [8, 2]], Alt.less);
<font color=blue>assert</font>(approxEqual(res.p, 0.01852));  <font color=green>// Odds ratio is very small in this case.
</font><font color=blue>assert</font>(approxEqual(res.testStat, 4.0 / 56.0));
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Fisher%27s_Exact_Test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">fisherExact</span>
<script>explorer.outline.addDecl('fisherExact');</script>

(T)(const T[][] <span class="funcparam">contingencyTable</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Convenience function.  Converts a dynamic array to a static one, then
calls the overload.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">ksTest</span>
<script>explorer.outline.addDecl('ksTest');</script>

(T, U)(T <span class="funcparam">F</span>, U <span class="funcparam">Fprime</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Performs a Kolmogorov-Smirnov (K-S) 2-sample test.  The K-S test is a
non-parametric test for a difference between two empirical distributions or
between an empirical distribution and a reference distribution.
<br><br>
<b>Returns:</b><br>
A TestRes with the K-S D value and a P value for the <b>null</b> that
FPrime is distributed identically to F against the alternative that it isn't.
This implementation uses a signed D value to indicate the direction of the
difference between distributions.  To get the D value used in standard
notation, simply take the absolute value of this D value.

<br><br>
<font color=red>BUGS:</font><br>
Exact calculation not implemented.  Uses asymptotic approximation.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">ksTest</span>
<script>explorer.outline.addDecl('ksTest');</script>

(T, Func)(T <span class="funcparam">Femp</span>, Func <span class="funcparam">F</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>One-sample Kolmogorov-Smirnov test against a reference distribution.
Takes a callable object for the CDF of refernce distribution.
<br><br>
<b>Returns:</b><br>
A TestRes with the Kolmogorov-Smirnov D value and a P value for the
<b>null</b> that Femp is a sample from F against the alternative that it isn't. This
implementation uses a signed D value to indicate the direction of the
difference between distributions.  To get the D value used in standard
notation, simply take the absolute value of this D value.

<br><br>
<font color=red>BUGS:</font><br>
Exact calculation not implemented.  Uses asymptotic approximation.

<br><br>
<b>Examples:</b><br>
<pre class="d_code"><font color=blue>auto</font> stdNormal = parametrize!(normalCDF)(0.0, 1.0);
<font color=blue>auto</font> empirical = [1, 2, 3, 4, 5];
<font color=blue>auto</font> res = <u>ksTest</u>(empirical, stdNormal);
</pre>

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">ksTestDestructive</span>
<script>explorer.outline.addDecl('ksTestDestructive');</script>

(T, U)(T <span class="funcparam">F</span>, U <span class="funcparam">Fprime</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Same as ksTest, except sorts in place, avoiding memory allocations.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">ksTestDestructive</span>
<script>explorer.outline.addDecl('ksTestDestructive');</script>

(T, Func)(T <span class="funcparam">Femp</span>, Func <span class="funcparam">F</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Ditto.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">runsTest</span>
<script>explorer.outline.addDecl('runsTest');</script>

(alias positive = "a &gt; 0", T)(T <span class="funcparam">obs</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Wald-wolfowitz or runs test for randomness of the distribution of
elements for which positive() evaluates to <b>true</b>.  For example, given
a sequence of coin flips [H,H,H,H,H,T,T,T,T,T] and a positive() function of
"a == 'H'", this test would determine that the heads are non-randomly
distributed, since they are all at the beginning of obs.  This is done
by counting the number of runs of consecutive elements for which
positive() evaluates to <b>true</b>, and the number of consecutive runs for which
it evaluates to <b>false</b>.  In the example above, we have 2 runs.  These are the
block of 5 consecutive heads at the beginning and the 5 consecutive tails
at the end.
<br><br>
Alternatives are Alt.less, meaning that less runs than expected have been
observed and data for which positive() is <b>true</b> tends to cluster,
Alt.greater, which means that more runs than expected have been observed
and data for which positive() is <b>true</b> tends to not cluster even moreso than
expected by chance, and Alt.twoSided, meaning that elements for which
positive() is <b>true</b> cluster as much as expected by chance.

<br><br>
<font color=red>BUGS:</font><br>
No exact calculation of the P-value.  Asymptotic approximation only.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Runs_test<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">RunsTest</span>
<script>explorer.outline.addDecl('RunsTest');</script>

(alias positive = "a &gt; 0",T);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Runs test as in runsTest(), except calculates online instead of from stored
array elements.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">put</span>
<script>explorer.outline.addDecl('put');</script>

(T <span class="funcparam">elem</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">uint 
<span class="currsymbol">nRuns</span>
<script>explorer.outline.addDecl('nRuns');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">double 
<span class="currsymbol">p</span>
<script>explorer.outline.addDecl('p');</script>

(Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd><br><br>
</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">pearsonCorTest</span>
<script>explorer.outline.addDecl('pearsonCorTest');</script>

(T, U)(T <span class="funcparam">range1</span>, U <span class="funcparam">range2</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Tests the hypothesis that the Pearson correlation between two ranges is
different from some 0.  Alternatives are Alt.less
(pearsonCor(range1, range2) &lt; 0), Alt.greater (pearsonCor(range1, range2)
 0) and Alt.twoSided (pearsonCor(range1, range2) != 0).
<br><br>
<b>Returns:</b><br>
A ConfInt of the estimated Pearson correlation of the two ranges,
the P-value against the given alternative, and the confidence interval of
the correlation at the level specified by confLevel.

<br><br>
<b>References:</b><br>
<br><br>
<b>http:</b><br>
//en.wikipedia.org/wiki/Pearson_correlation<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">ConfInt 
<span class="currsymbol">pearsonCorTest</span>
<script>explorer.outline.addDecl('pearsonCorTest');</script>

()(double <span class="funcparam">cor</span>, double <span class="funcparam">N</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, double <span class="funcparam">confLevel</span> = 0.95);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Same as overload, but uses pre-computed correlation coefficient and sample
size instead of computing them.
<br><br>
<b>Note:</b><br>
This is a template only because of DMD Bug 2972.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">spearmanCorTest</span>
<script>explorer.outline.addDecl('spearmanCorTest');</script>

(T, U)(T <span class="funcparam">range1</span>, U <span class="funcparam">range2</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Tests the hypothesis that the Spearman correlation between two ranges is
different from some 0.  Alternatives are
Alt.less (spearmanCor(range1, range2) &lt; 0), Alt.greater (spearmanCor(range1, range2)
&gt; 0) and Alt.twoSided (spearmanCor(range1, range2) != 0).
<br><br>
<b>Returns:</b><br>
A TestRes containing the Spearman correlation coefficient and
the P-value for the given alternative.

<br><br>
<font color=red>BUGS:</font><br>
Exact P-value computation not yet implemented.  Uses asymptotic
approximation only.  This is good enough for most practical purposes given
reasonably large N, but is not perfectly accurate.  Not valid for data with
very large amounts of ties.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">kendallCorTest</span>
<script>explorer.outline.addDecl('kendallCorTest');</script>

(T, U)(T <span class="funcparam">range1</span>, U <span class="funcparam">range2</span>, Alt <span class="funcparam">alt</span> = Alt.twoSided, uint <span class="funcparam">exactThresh</span> = 50);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Tests the hypothesis that the Kendall Tau-b between two ranges is
different from 0.  Alternatives are Alt.less (kendallCor(range1, range2) &lt; 0),
Alt.greater (kendallCor(range1, range2) &gt; 0) and Alt.twoSided
(kendallCor(range1, range2) != 0).
<br><br>
exactThresh controls the maximum length of the range for which exact P-value
computation is used.  The default is 50.  Exact calculation is never used
when ties are present because it is not computationally feasible.
Do not set this higher than 100, as it will be very slow
and the asymptotic approximation is pretty good at even a fraction of this
size.

<br><br>
<b>Note:</b><br>
As an optimization, when a range is a SortedRange with predicate "a &lt; b",
it is assumed already sorted and not sorted a second time by this function.
This is useful when applying this function multiple times with one of the
arguments the same every time.

<br><br>
<b>Returns:</b><br>
A TestRes containing the Kendall correlation coefficient and
the P-value for the given alternative.

<br><br>
<b>References:</b><br>
StackOverflow Question 948341 (http://stackoverflow.com/questions/948341)
<br><br>

The Variance of Tau When Both Rankings Contain Ties.  M.G. Kendall.
Biometrika, Vol 34, No. 3/4 (Dec., 1947), pp. 297-298<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">dAgostinoK</span>
<script>explorer.outline.addDecl('dAgostinoK');</script>

(T)(T <span class="funcparam">range</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A test for normality of the distribution of a range of values.  Based on
 the assumption that normally distributed values will have a sample skewness
 and sample kurtosis very close to zero.
<br><br>
<b>Returns:</b><br>
A TestRes with the K statistic, which is Chi-Square distributed
 with 2 degrees of freedom under the <b>null</b>, and the P-value for the alternative
 that the data has skewness and kurtosis not equal to zero against the <b>null</b>
 that skewness and kurtosis are near zero.  A normal distribution always has
 skewness and kurtosis that converge to zero as sample size goes to infinity.

<br><br>
<b>Notes:</b><br>
Contrary to popular belief, tests for normality should usually
 not be used to deterimine whether T-tests are valid.  If the sample size is
 large, T-tests are valid regardless of the distribution due to the central
 limit theorem.  If the sample size is small, a test for normality will
 likely not be very powerful, and a priori knowledge or simple inspection
 of the data is often a better idea.

<br><br>
<b>References:</b><br>
D'Agostino, Ralph B., Albert Belanger, and Ralph B. D'Agostino, Jr.
 "A Suggestion for Using Powerful and Informative Tests of Normality",
 The American Statistician, Vol. 44, No. 4. (Nov., 1990), pp. 316-321.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">TestRes 
<span class="currsymbol">fishersMethod</span>
<script>explorer.outline.addDecl('fishersMethod');</script>

(R)(R <span class="funcparam">pVals</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Fisher's method of meta-analyzing a set of P-values to determine whether
 there are more significant results than would be expected by chance.
 Based on a chi-square statistic for the sum of the logs of the P-values.
<br><br>
<b>Returns:</b><br>
A TestRes containing the chi-square statistic and a P-value for
 the alternative hypothesis that more small P-values than would be expected
 by chance are present against the alternative that the distribution of
 P-values is uniform or enriched for large P-values.

<br><br>
<b>References:</b><br>
Fisher, R. A. (1948) "Combining independent tests of
 significance", American Statistician, vol. 2, issue 5, page 30.
 (In response to Question 14)<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">enum 
<span class="currsymbol">Dependency</span>
<script>explorer.outline.addDecl('Dependency');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>For falseDiscoveryRate.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">yes</span>
<script>explorer.outline.addDecl('yes');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Assume that dependency among hypotheses may exist.  (More conservative,
    Benjamini-Yekutieli procedure.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">no</span>
<script>explorer.outline.addDecl('no');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Assume hypotheses are independent.  (Less conservative, Benjamine-
    Hochberg procedure.)<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">float[] 
<span class="currsymbol">falseDiscoveryRate</span>
<script>explorer.outline.addDecl('falseDiscoveryRate');</script>

(T)(T <span class="funcparam">pVals</span>, Dependency <span class="funcparam">dep</span> = Dependency.no);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Computes the <b>false</b> discovery rate statistic given a list of
p-values, according to Benjamini and Hochberg (1995) (independent) or
Benjamini and Yekutieli (2001) (dependent).  The Dependency parameter
controls whether hypotheses are assumed to be independent, or whether
the more conservative assumption that they are correlated must be made.
<br><br>
<b>Returns:</b><br>
An array of adjusted P-values with indices corresponding to the order of
the P-values in the input data.

<br><br>
<b>References:</b><br>
Benjamini, Y., and Hochberg, Y. (1995). Controlling the <b>false</b> discovery rate:
a practical and powerful approach to multiple testing. Journal of the Royal
Statistical Society Series B, 57, 289-200
<br><br>

Benjamini, Y., and Yekutieli, D. (2001). The control of the <b>false</b> discovery
rate in multiple testing under dependency. Annals of Statistics 29, 1165-1188.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">float[] 
<span class="currsymbol">hochberg</span>
<script>explorer.outline.addDecl('hochberg');</script>

(T)(T <span class="funcparam">pVals</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Uses the Hochberg procedure to control the familywise error rate assuming
 that hypothesis tests are independent.  This is more powerful than
 Holm-Bonferroni correction, but requires the independence assumption.
<br><br>
<b>Returns:</b><br>
An array of adjusted P-values with indices corresponding to the order of
 the P-values in the input data.

<br><br>
<b>References:</b><br>
Hochberg, Y. (1988). A sharper Bonferroni procedure for multiple tests of
 significance. Biometrika, 75, 800-803.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">float[] 
<span class="currsymbol">holmBonferroni</span>
<script>explorer.outline.addDecl('holmBonferroni');</script>

(T)(T <span class="funcparam">pVals</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Uses the Holm-Bonferroni method to adjust a set of P-values in a way that
 controls the familywise error rate (The probability of making at least one
 Type I error).  This is basically a less conservative version of
 Bonferroni correction that is still valid for arbitrary assumptions and
 controls the familywise error rate.  Therefore, there aren't too many good
 reasons to use regular Bonferroni correction instead.
<br><br>
<b>Returns:</b><br>
An array of adjusted P-values with indices corresponding to the order of
 the P-values in the input data.

<br><br>
<b>References:</b><br>
Holm, S. (1979). A simple sequentially rejective multiple test procedure.
 Scandinavian Journal of Statistics, 6, 65-70.<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</td></tr>
		<tr><td id="docfooter">
			Page was generated with
			<img src="candydoc/img/candydoc.gif" style="vertical-align:middle; position:relative; top:-1px">
			on Thu Dec 15 20:40:33 2011

		</td></tr>
	</table>
</div>
<script>
    explorer.packageExplorer.addModule("dstats.all");
	explorer.packageExplorer.addModule("dstats.alloc");
	explorer.packageExplorer.addModule("dstats.base");
	explorer.packageExplorer.addModule("dstats.cor");
	explorer.packageExplorer.addModule("dstats.distrib");
	explorer.packageExplorer.addModule("dstats.infotheory");
	explorer.packageExplorer.addModule("dstats.random");
	explorer.packageExplorer.addModule("dstats.pca");
	explorer.packageExplorer.addModule("dstats.kerneldensity");
	explorer.packageExplorer.addModule("dstats.regress");	
	explorer.packageExplorer.addModule("dstats.sort");
	explorer.packageExplorer.addModule("dstats.summary");
	explorer.packageExplorer.addModule("dstats.tests");
</script>
</body></html>


